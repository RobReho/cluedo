<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>exprolab: Experimental robotic lab</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">exprolab
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Experimental Robotics Lab _ Assignment 1</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Experimental robotic lab </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>First assignment for the Experimental Robotic Lab course a.y.2021/2022</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Introduction</h1>
<p>At this stage of the project, the robot is a point that aims to explore its environment and deduce hypotheses based on hints it finds in different rooms. The robot has been designed to move randomly through the environment, entering different rooms and looking around for hints to make hypotheses. If a consistent hypothesis can be deduced, the robot will go to a designated location and express it in English. If the hypothesis is incorrect, the robot will continue exploring and finding new hints until a correct hypothesis is deduced.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Software architecture</h1>
<h2><a class="anchor" id="autotoc_md3"></a>
ROS nodes</h2>
<p>The nodes in this package are:</p><ul>
<li>"cluedo_state_machine": handles the communication with the ARMOR server.</li>
<li>"oracle": controls the hints generation and holds the solution of the game.</li>
<li>"user_interface": subscribes to the other node's messages and prints the on the terminal. The node is not represented in the following diagrams for sake of semplicity.</li>
</ul>
<h2><a class="anchor" id="autotoc_md4"></a>
ROS services</h2>
<p>The nodes communicate with some customized services:</p><ul>
<li>"/verify_solution" of type Compare</li>
<li>'/generate_murder' of type Hypothesis</li>
<li>'/get_hint' of type Hints</li>
</ul>
<h2><a class="anchor" id="autotoc_md5"></a>
Temporal Diagram</h2>
<p>In the following temporal diagram is showed he communication between the nodes. <br  />
</p>
<p><img src="https://github.com/RobReho/exproblab/blob/main/media/erl1_temp.PNG" alt="Alt Text" class="inline"/> <br  />
</p>
<p>The initialization is handled by the "cluedo_state_machine" node, which calls the appropriate services of the ARMOR server to make the ontology ready for the game and calls the service server /generate_murder to generate a winning hypothesis and store it for the following comparisons. During the game, the "cluedo_state_machine" node asks for hints to the oracle by calling the service /get_hint, and it gets a hypothesis. Such hypothesis will be uploaded to the ontology, and the ARMOR server will be asked to reason with the new information and retrieve the classes "COMPLETE" and "INCONISTENT". If the hypothesis just uploaded is part of the class "COMPLETE" but not of the class "INCONISTENT", that means that it is a consistent hypothesis and can be queried to the Oracle. The "cluedo_state_machine" node does so by calling the service /verify_solution that will return 3 booleans for each element of the hypothesis (person, weapon, place). If all the booleans are true, the hypothesis is correct, and the game ends.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
State Machine</h2>
<p>The different states implement with the Smach package are showed below. <br  />
</p>
<p><img src="https://github.com/RobReho/exproblab/blob/main/media/sm1.PNG" alt="Alt Text" class="inline"/> <br  />
</p>
<p>The states are implemented in the "cluedo_state_machine" node.</p><ul>
<li>The INIT state establishes communication with the Armor server, loads the OWL file, calls the "generate murder" service to start the game, and retrieves the list of people, weapons, and places from the OWL.</li>
<li>The EXPLORE state retrieves the list of available places, randomly chooses one, and simulates reaching the place by sleeping for 1 second.</li>
<li>The MAKE HYPOTHESIS state asks the server to provide a new hint, loads it onto the ontology, and retrieves the classes "COMPLETE" and "INCONSISTENT" to check for consistency. If the hypothesis is consistent, the executed state is REACH ORACLE; otherwise, it goes back to the EXPLORE state.</li>
<li>The REACH ORACLE state simulates reaching the oracle position by sleeping for 1 second. Although the possibility of this state failing is implemented in the state machine, it is never executed. The possibility is left for future implementations where an actual action will be implemented. Once the oracle is reached, the next executed state is DELIVER HYPOTHESIS.</li>
<li>The DELIVER HYPOTHESIS state gets the person, weapon, and place of the hypothesis and expresses it in natural language. The next state is HYPOTHESIS CHECK.</li>
<li>The HYPOTHESIS CHECK state calls the "verify solution" server to compare the hypothesis with the correct one. If all the booleans returned are true, the game ends; otherwise, the hypothesis is wrong, and the program executes the EXPLORE state. </li>
</ul>
<h1><a class="anchor" id="autotoc_md7"></a>
Installation and Running</h1>
<p>This project needs some external packages. You can install them in your ROS workspace: <br  />
 ARMOR </p><div class="fragment"><div class="line">git clone https://github.com/EmaroLab/armor.git</div>
</div><!-- fragment --><p>SMASH </p><div class="fragment"><div class="line">git clone https://github.com/ros/executive_smach.git</div>
<div class="line">git clone https://github.com/ros-visualization/executive_smach_visualization.git</div>
</div><!-- fragment --><p>To install the package clone the repository in your ROS workspace: </p><div class="fragment"><div class="line">git clone https://github.com/RobReho/exproblab.git</div>
</div><!-- fragment --><p>then build your ROS workspace: </p><div class="fragment"><div class="line">catkin_make</div>
</div><!-- fragment --><p>To run the project launch the mani launch file: </p><div class="fragment"><div class="line">roslaunch cluedo launcher.launch</div>
</div><!-- fragment --><p>To visualize the Smash state machine graph, run in another tab: </p><div class="fragment"><div class="line">rosrun smach_viewer smach_viewer.py</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md8"></a>
Demo</h1>
<p><img src="https://github.com/RobReho/exproblab/blob/main/media/State_machine.gif" alt="Alt Text" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md9"></a>
Working hypothesis and environment.</h1>
<h2><a class="anchor" id="autotoc_md10"></a>
System features</h2>
<p>The game is a revisited simulated Cluedo game, where the player is the robot implemented by the state machine, and the game is controlled by the Oracle. The Oracle generates the hypothesis by choosing random elements in the people, weapons, and places arrays. Randomly, it might generate an inconsistent hypothesis, meaning that it will be composed of 4 elements instead of 3. The robot will get both consistent and inconsistent hypotheses and send back only the consistent hypothesis to be compared with the solution. When a hypothesis is compared to the solution, the hints that don't match are discarded from the hints arrays stored in the Oracle node. As more hypotheses are compared, it becomes more and more likely that the proposed hypothesis matches the solution. <img src="https://github.com/RobReho/exproblab/blob/main/media/erl1_end.PNG" alt="Alt Text" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md11"></a>
System limitations</h2>
<p>The game implemented has a very simple structure and does not use any IDs associated with the hypothesis. The architecture of the game has a very different way of generating and handling hypotheses compared to the following iterations. Nevertheless, the simplicity of the architecture makes it easy to adapt to future implementations. </p>
<h2><a class="anchor" id="autotoc_md12"></a>
Possible technical Improvements</h2>
<p>Possible improvements include a system that generates hints in a similar way to what happens in the following iterations.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Contacts</h1>
<p>Roberta Reho: <a href="#" onclick="location.href='mai'+'lto:'+'s50'+'75'+'214'+'@s'+'tud'+'en'+'ti.'+'un'+'ige'+'.i'+'t'; return false;">s5075<span style="display: none;">.nosp@m.</span>214@<span style="display: none;">.nosp@m.</span>stude<span style="display: none;">.nosp@m.</span>nti.<span style="display: none;">.nosp@m.</span>unige<span style="display: none;">.nosp@m.</span>.it</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
